View(HD_var_data)
#View(HD_var_data)
(HD_var_table <-table(HD_var_data))
#View(HD_var_data)
(as.table(HD_var_data))
HD_var_data <- data.frame(
Variable = c("age", "gender", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target"),
Description = c("age of patient", "gender: 0=Female, 1=Male", "chest pain: 0=Typical Angina: chest pain related to decrease blood supply to the heart, 1=Atypical Angina: chest pain not related to the heart, 2=Non-Anginal Pain: typical esophigeal spasms (not heart related), 3=Asymptomatic: chest pain not showing signs of heart disease", "trestbps: resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern", "cholesterol: serum cholesterol in mg/dl (milligrams per deciliter) (serum = LDL + HDL + .2*triglycerides)", "fasting blood sugar: > 120 mg/dl (milligrams per deciliter) (1=true, 0=false) (> 126 mg/dl signals diabetes)", "resting electrocardiographic (EKG or ECG): 0=nothing to note, 1=ST-T Wave abnormality (can range from mile symptoms to severe problems, signals non-normal heart beat), 2=Possible or definite left ventricular hypertrophy (enlarged heart's main pumping chamber)", "thalach: maximum heart rate achieved", "exang: exercise induced angina (1=true, 0=false)", "oldpeak: ST depression induced by exercise relative to rest looks at stress of heart during exercise (unhealthy heart will stress more)", "slope: the slope of the peak exercise ST segment, 0=Upsloping: better heart rate with exercise (uncommon), 1=Flatsloping: minimal change (typical healthy heart), 2=Downsloping: signs of unhealthy heart", "ca: number of major vessels (0-3) colored by fluoroscopy (procedure to see blood flow)", "thallium stress test: (a nuclear imaging test that shows how well blood flows into the heart while you are exercising or at rest), 1=normal, 2=fixed defect: used to be defect but now is okay, 3=reversable defect: no proper blood movement when exercising", "target: have disease (1=yes) or not (0=no)")
)
View(HD_var_data)
#View(HD_var_data)
matrix(HD_var_data)
#View(HD_var_data)
knitr::kable(HD_var_data)
#View(HD_var_data)
knitr::kable(HD_var_data, format = "markdown")
knitr::opts_chunk$set(echo = TRUE)
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(readr)) install.packages('readr')
if (!require(ggfortify)) install.packages('ggfortify')
if (!require(kableExtra)) install.packages('kableExtra')
if (!require(gt)) install.packages('gt')
if (!require(heatmaply)) install.packages('heatmaply')
if (!require(misty)) install.packages('misty')
library(misty)
library(gt)
library(dplyr)
library(heatmaply)
library(ggplot2)
library(HeartDisease)
#View(HeartDisease)
HD_var_data <- data.frame(
Variable = c("age", "gender", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target"),
Description = c("age of patient", "gender: 0=Female, 1=Male", "chest pain: 0=Typical Angina: chest pain related to decrease blood supply to the heart, 1=Atypical Angina: chest pain not related to the heart, 2=Non-Anginal Pain: typical esophigeal spasms (not heart related), 3=Asymptomatic: chest pain not showing signs of heart disease", "trestbps: resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern", "cholesterol: serum cholesterol in mg/dl (milligrams per deciliter) (serum = LDL + HDL + .2*triglycerides)", "fasting blood sugar: > 120 mg/dl (milligrams per deciliter) (1=true, 0=false) (> 126 mg/dl signals diabetes)", "resting electrocardiographic (EKG or ECG): 0=nothing to note, 1=ST-T Wave abnormality (can range from mile symptoms to severe problems, signals non-normal heart beat), 2=Possible or definite left ventricular hypertrophy (enlarged heart's main pumping chamber)", "thalach: maximum heart rate achieved", "exang: exercise induced angina (1=true, 0=false)", "oldpeak: ST depression induced by exercise relative to rest looks at stress of heart during exercise (unhealthy heart will stress more)", "slope: the slope of the peak exercise ST segment, 0=Upsloping: better heart rate with exercise (uncommon), 1=Flatsloping: minimal change (typical healthy heart), 2=Downsloping: signs of unhealthy heart", "ca: number of major vessels (0-3) colored by fluoroscopy (procedure to see blood flow)", "thallium stress test: (a nuclear imaging test that shows how well blood flows into the heart while you are exercising or at rest), 1=normal, 2=fixed defect: used to be defect but now is okay, 3=reversable defect: no proper blood movement when exercising", "target: have disease (1=yes) or not (0=no)")
)
#View(HD_var_data)
knitr::kable(HD_var_data, format = "markdown")
target_graph <- ggplot(HeartDisease, aes(target)) +
geom_bar() +
ggtitle("Count of people with heart disease")
target_graph %>% plotly::ggplotly()
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
cp_graph <- ggplot(HeartDisease, aes(cp)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Chest Pain") +
xlab("Chest Pain") +
theme(legend.position = "none")
cp_graph %>% plotly::ggplotly()
fbs_graph <- ggplot(HeartDisease, aes(fbs)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Fasting Blood Sugar") +
xlab("Fasting blood sugar") +
theme(legend.position = "none")
fbs_graph %>% ggplotly()
restecg_graph <- ggplot(HeartDisease, aes(restecg)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Resting ECG") +
xlab("Resting ECG") +
theme(legend.position = "none")
restecg_graph %>% ggplotly()
exang_graph <- ggplot(HeartDisease, aes(exang)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Exercise Induced Angina") +
xlab("exercise induced angine") +
theme(legend.position = "none")
exang_graph %>% ggplotly()
slope_graph <- ggplot(HeartDisease, aes(slope)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Slope") +
xlab("Slope") +
theme(legend.position = "none")
slope_graph %>% ggplotly()
ca_graph <- ggplot(HeartDisease, aes(ca)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Blood Flow") +
xlab("Flouroscopy blood flow") +
theme(legend.position = "none")
ca_graph %>% ggplotly()
thal_graph <- ggplot(HeartDisease, aes(thal)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
#(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Thallium Stress Test") +
xlab("Thallium stress test") +
theme(legend.margin = c("No Heart Disease", "Have Heart Disease"))
thal_graph %>% ggplotly()
cowplot::plot_grid(hd_graph, cp_graph, fbs_graph, restecg_graph, exang_graph, slope_graph, ca_graph, thal_graph)
knitr::opts_chunk$set(echo = TRUE)
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(readr)) install.packages('readr')
if (!require(ggfortify)) install.packages('ggfortify')
if (!require(kableExtra)) install.packages('kableExtra')
if (!require(gt)) install.packages('gt')
if (!require(heatmaply)) install.packages('heatmaply')
if (!require(misty)) install.packages('misty')
library(misty)
library(gt)
library(dplyr)
library(heatmaply)
library(ggplot2)
library(HeartDisease)
#View(HeartDisease)
HD_var_data <- data.frame(
Variable = c("age", "gender", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target"),
Description = c("age of patient", "gender: 0=Female, 1=Male", "chest pain: 0=Typical Angina: chest pain related to decrease blood supply to the heart, 1=Atypical Angina: chest pain not related to the heart, 2=Non-Anginal Pain: typical esophigeal spasms (not heart related), 3=Asymptomatic: chest pain not showing signs of heart disease", "trestbps: resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern", "cholesterol: serum cholesterol in mg/dl (milligrams per deciliter) (serum = LDL + HDL + .2*triglycerides)", "fasting blood sugar: > 120 mg/dl (milligrams per deciliter) (1=true, 0=false) (> 126 mg/dl signals diabetes)", "resting electrocardiographic (EKG or ECG): 0=nothing to note, 1=ST-T Wave abnormality (can range from mile symptoms to severe problems, signals non-normal heart beat), 2=Possible or definite left ventricular hypertrophy (enlarged heart's main pumping chamber)", "thalach: maximum heart rate achieved", "exang: exercise induced angina (1=true, 0=false)", "oldpeak: ST depression induced by exercise relative to rest looks at stress of heart during exercise (unhealthy heart will stress more)", "slope: the slope of the peak exercise ST segment, 0=Upsloping: better heart rate with exercise (uncommon), 1=Flatsloping: minimal change (typical healthy heart), 2=Downsloping: signs of unhealthy heart", "ca: number of major vessels (0-3) colored by fluoroscopy (procedure to see blood flow)", "thallium stress test: (a nuclear imaging test that shows how well blood flows into the heart while you are exercising or at rest), 1=normal, 2=fixed defect: used to be defect but now is okay, 3=reversable defect: no proper blood movement when exercising", "target: have disease (1=yes) or not (0=no)")
)
#View(HD_var_data)
knitr::kable(HD_var_data, format = "markdown")
target_graph <- ggplot(HeartDisease, aes(target)) +
geom_bar() +
ggtitle("Count of people with heart disease")
target_graph %>% plotly::ggplotly()
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
cp_graph <- ggplot(HeartDisease, aes(cp)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Chest Pain") +
xlab("Chest Pain") +
theme(legend.position = "none")
cp_graph %>% plotly::ggplotly()
fbs_graph <- ggplot(HeartDisease, aes(fbs)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Fasting Blood Sugar") +
xlab("Fasting blood sugar") +
theme(legend.position = "none")
fbs_graph %>% ggplotly()
restecg_graph <- ggplot(HeartDisease, aes(restecg)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Resting ECG") +
xlab("Resting ECG") +
theme(legend.position = "none")
restecg_graph %>% ggplotly()
exang_graph <- ggplot(HeartDisease, aes(exang)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Exercise Induced Angina") +
xlab("exercise induced angine") +
theme(legend.position = "none")
exang_graph %>% ggplotly()
slope_graph <- ggplot(HeartDisease, aes(slope)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Slope") +
xlab("Slope") +
theme(legend.position = "none")
slope_graph %>% ggplotly()
ca_graph <- ggplot(HeartDisease, aes(ca)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Blood Flow") +
xlab("Flouroscopy blood flow") +
theme(legend.position = "none")
ca_graph %>% ggplotly()
thal_graph <- ggplot(HeartDisease, aes(thal)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
#(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Thallium Stress Test") +
xlab("Thallium stress test") +
theme(legend.margin = c("No Heart Disease", "Have Heart Disease"))
thal_graph %>% ggplotly()
cowplot::plot_grid(gender_graph, cp_graph, fbs_graph, restecg_graph, exang_graph, slope_graph, ca_graph, thal_graph)
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
knitr::opts_chunk$set(echo = TRUE)
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(readr)) install.packages('readr')
if (!require(ggfortify)) install.packages('ggfortify')
if (!require(kableExtra)) install.packages('kableExtra')
if (!require(gt)) install.packages('gt')
if (!require(heatmaply)) install.packages('heatmaply')
if (!require(misty)) install.packages('misty')
library(misty)
library(gt)
library(dplyr)
library(heatmaply)
library(ggplot2)
library(HeartDisease)
#View(HeartDisease)
HD_var_data <- data.frame(
Variable = c("age", "gender", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target"),
Description = c("age of patient", "gender: 0=Female, 1=Male", "chest pain: 0=Typical Angina: chest pain related to decrease blood supply to the heart, 1=Atypical Angina: chest pain not related to the heart, 2=Non-Anginal Pain: typical esophigeal spasms (not heart related), 3=Asymptomatic: chest pain not showing signs of heart disease", "trestbps: resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern", "cholesterol: serum cholesterol in mg/dl (milligrams per deciliter) (serum = LDL + HDL + .2*triglycerides)", "fasting blood sugar: > 120 mg/dl (milligrams per deciliter) (1=true, 0=false) (> 126 mg/dl signals diabetes)", "resting electrocardiographic (EKG or ECG): 0=nothing to note, 1=ST-T Wave abnormality (can range from mile symptoms to severe problems, signals non-normal heart beat), 2=Possible or definite left ventricular hypertrophy (enlarged heart's main pumping chamber)", "thalach: maximum heart rate achieved", "exang: exercise induced angina (1=true, 0=false)", "oldpeak: ST depression induced by exercise relative to rest looks at stress of heart during exercise (unhealthy heart will stress more)", "slope: the slope of the peak exercise ST segment, 0=Upsloping: better heart rate with exercise (uncommon), 1=Flatsloping: minimal change (typical healthy heart), 2=Downsloping: signs of unhealthy heart", "ca: number of major vessels (0-3) colored by fluoroscopy (procedure to see blood flow)", "thallium stress test: (a nuclear imaging test that shows how well blood flows into the heart while you are exercising or at rest), 1=normal, 2=fixed defect: used to be defect but now is okay, 3=reversable defect: no proper blood movement when exercising", "target: have disease (1=yes) or not (0=no)")
)
#View(HD_var_data)
knitr::kable(HD_var_data, format = "markdown")
target_graph <- ggplot(HeartDisease, aes(target)) +
geom_bar() +
ggtitle("Count of people with heart disease")
target_graph %>% plotly::ggplotly()
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
cp_graph <- ggplot(HeartDisease, aes(cp)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Chest Pain") +
xlab("Chest Pain") +
theme(legend.position = "none")
cp_graph %>% plotly::ggplotly()
fbs_graph <- ggplot(HeartDisease, aes(fbs)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Fasting Blood Sugar") +
xlab("Fasting blood sugar") +
theme(legend.position = "none")
fbs_graph %>% ggplotly()
restecg_graph <- ggplot(HeartDisease, aes(restecg)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease By Resting ECG") +
xlab("Resting ECG") +
theme(legend.position = "none")
restecg_graph %>% ggplotly()
exang_graph <- ggplot(HeartDisease, aes(exang)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Exercise Induced Angina") +
xlab("exercise induced angine") +
theme(legend.position = "none")
exang_graph %>% ggplotly()
slope_graph <- ggplot(HeartDisease, aes(slope)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Slope") +
xlab("Slope") +
theme(legend.position = "none")
slope_graph %>% ggplotly()
ca_graph <- ggplot(HeartDisease, aes(ca)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Blood Flow") +
xlab("Flouroscopy blood flow") +
theme(legend.position = "none")
ca_graph %>% ggplotly()
thal_graph <- ggplot(HeartDisease, aes(thal)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
#(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Thallium Stress Test") +
xlab("Thallium stress test") +
theme(legend.margin = c("No Heart Disease", "Have Heart Disease"))
thal_graph %>% ggplotly()
cowplot::plot_grid(gemder_graph, cp_graph, fbs_graph, restecg_graph, exang_graph, slope_graph, ca_graph, thal_graph)
knitr::opts_chunk$set(echo = TRUE)
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(readr)) install.packages('readr')
if (!require(ggfortify)) install.packages('ggfortify')
if (!require(kableExtra)) install.packages('kableExtra')
if (!require(gt)) install.packages('gt')
if (!require(heatmaply)) install.packages('heatmaply')
if (!require(misty)) install.packages('misty')
library(misty)
library(gt)
library(dplyr)
library(heatmaply)
library(ggplot2)
library(flextable)
library(officer)
ft <- qflextable(HD_var_data)
library(HeartDisease)
#View(HeartDisease)
knitr::opts_chunk$set(echo = TRUE)
if (!require(tidyverse)) install.packages('tidyverse')
if (!require(readr)) install.packages('readr')
if (!require(ggfortify)) install.packages('ggfortify')
if (!require(kableExtra)) install.packages('kableExtra')
if (!require(gt)) install.packages('gt')
if (!require(heatmaply)) install.packages('heatmaply')
if (!require(misty)) install.packages('misty')
library(misty)
library(gt)
library(dplyr)
library(heatmaply)
library(ggplot2)
library(flextable)
library(HeartDisease)
#View(HeartDisease)
HD_var_data <- data.frame(
Variable = c("age", "gender", "cp", "trestbps", "chol", "fbs", "restecg", "thalach", "exang", "oldpeak", "slope", "ca", "thal", "target"),
Description = c("age of patient",
"0 = Female\n1 = Male",
"chest pain:\n 0 = Typical Angina: chest pain related to decrease blood supply to the heart\n 1 = Atypical Angina: chest pain not related to the heart\n 2 = non-Anginal Pain: typical esophageal spasms (not heart related)\n 3 = Asymptomatic: chest pain not showing signs of heart disease",
"Resting blood pressure (in mm Hg on admission to the hospital) anything above 130-140 is typically cause for concern",
"Cholesterol: serum cholesterol in mg/dl (milligrams per deciliter)\n serum = LDL + HDL + .2*triglycerides",
"Fasting blood sugar: > 120 mg/dl (milligrams per deciliter)\n 1 = true\n 0 = false\n (> 126 mg/dl signals diabetes)",
"Resting electrocardiographic (EKG or ECG):\n 0 = nothing to note\n 1 = ST-T Wave abnormality (can range from mile symptoms to severe problems, signals non-normal heart beat)\n 2 = Possible or definite left ventricular hypertrophy (enlarged heart's main pumping chamber)",
"Maximum heart rate achieved",
"Exercise induced angina\n 1 = true\n 0 = false",
"ST depression induced by exercise relative to rest looks at stress of heart during exercise (unhealthy heart will stress more)",
"The slope of the peak exercise ST segment\n 0 = Upsloping: better heart rate with exercise (uncommon)\n 1 = Flatsloping: minimal change (typical healthy heart)\n 2 = Downsloping: signs of unhealthy heart",
"Number of major vessels (0-3) colored by fluoroscopy (procedure to see blood flow)",
"Thallium stress test: (a nuclear imaging test that shows how well blood flows into the heart while you are exercising or at rest)\n 1 = normal\n 2 = fixed defect: used to be defect but now is okay\n 3 = reversable defect: no proper blood movement when exercising",
" 0 = do not have heart disease\n 1 = have heart disease")
)
library(officer)
ft <- qflextable(HD_var_data)
read_docx() %>%
body_add_flextable(value = ft) %>%
print(target = "C:/Users/dutch/OneDrive/Desktop/HD_var_data.docx")
target_graph <- ggplot(HeartDisease, aes(target)) +
geom_bar() +
ggtitle("Count of people with heart disease")
target_graph %>% plotly::ggplotly()
gender_graph <- ggplot(HeartDisease, aes(gender)) +
geom_bar(aes(fill=target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Female", "Male" )) +
ggtitle("Heart Disease by Gender") +
xlab("Gender") +
theme(legend.position = "none")
gender_graph %>% plotly::ggplotly()
cp_graph <- ggplot(HeartDisease, aes(cp)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Typical Angina", "Atypical Angina", "Non-Anginal Pain", "Asymptomatic" )) +
ggtitle("Heart Disease By Chest Pain") +
xlab("Chest Pain") +
theme(legend.position = "none")
cp_graph %>% plotly::ggplotly()
fbs_graph <- ggplot(HeartDisease, aes(fbs)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("False", "True" )) +
ggtitle("Heart Disease by Fasting Blood Sugar") +
xlab("Fasting blood sugar > 120 mg/dl") +
theme(legend.position = "none")
fbs_graph %>% ggplotly()
restecg_graph <- ggplot(HeartDisease, aes(restecg)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Normal", "ST-T Wave Abnormal", "Left Ventricular Hypertorphy" )) +
ggtitle("Heart Disease By Resting ECG") +
xlab("Resting ECG") +
theme(legend.position = "none")
restecg_graph %>% ggplotly()
exang_graph <- ggplot(HeartDisease, aes(exang)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("False", "True" )) +
ggtitle("Heart Disease by Exercise Induced Angina") +
xlab("exercise induced angine") +
theme(legend.position = "none")
exang_graph %>% ggplotly()
slope_graph <- ggplot(HeartDisease, aes(slope)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Upsloping", "Flatsloping", "Downsloping" )) +
ggtitle("Heart Disease by Slope") +
xlab("Slope") +
theme(legend.position = "none")
slope_graph %>% ggplotly()
ca_graph <- ggplot(HeartDisease, aes(ca)) +
geom_bar(aes(fill = target)) +
scale_fill_manual(values = c("gray", 'navy')) +
scale_x_discrete(labels=c("Low", "Medium", "High", "Unknown", "Unknown" )) +
ggtitle("Heart Disease by Blood Flow") +
xlab("Flouroscopy blood flow") +
theme(legend.position = "none")
ca_graph %>% ggplotly()
HD_target <- HeartDisease %>%
mutate(target = ifelse(target == 0, "No", "Yes")) %>%
rename_at("target", ~ "Heart_Disease")
thal_graph <- ggplot(HD_target, aes(thal)) +
geom_bar(aes(fill = Heart_Disease)) +
labs(title = "Heart Disease by Thallium Stress Test", x = "Thallium Stress Test") +
scale_fill_manual(values = c("gray", "navy"))
thal_graph %>% ggplotly()
legend <- cowplot::get_legend(thal_graph)
cowplot::plot_grid(gender_graph, cp_graph, fbs_graph, restecg_graph, exang_graph, slope_graph, ca_graph, thal_graph +
theme(legend.position = "none"), legend)
# HeartDisease1 <- HeartDisease %>%
#   select(age, trestbps, chol, oldpeak)
# HeartDisease2 <- HeartDisease %>%
#   select(gender, cp, fbs, restecg, exang, slope, ca, thal, target)
# logistic <- glm(target ~ ., HeartDisease, family = "binomial")
# summary(logistic)
# caret::varImp(logistic)
# pscl::pR2(logistic)["McFadden"]
# car::vif(logistic)
smallest <- I(target == 1) ~ 1
largest <- I(target == 1) ~ age + gender + cp + trestbps + chol + fbs + restecg + thalach + exang + oldpeak + slope + ca + thal
stepwise.glm.target = glm(I( target== 1) ~ 1, data=HeartDisease, family='binomial')
step(stepwise.glm.target, scope=list(lower=smallest, upper=largest))
hd_logistic <- glm(target ~ thal + ca + cp + oldpeak + slope + gender + trestbps + exang, data = HeartDisease, family = "binomial")
summary(hd_logistic)
caret::varImp(hd_logistic)
pscl::pR2(hd_logistic)["McFadden"]
car::vif(hd_logistic)
# log_model <- glm(target ~ age, data = HeartDisease, family = binomial)
# pred_data <- data.frame(age = seq(min(HeartDisease$age), max(HeartDisease$age), len = 300))
# pred_data$target <- predict(log_model, pred_data, type = 'response')
# plot(target ~ age, data = HeartDisease)
# lines(target ~ age, pred_data, lwd = 2, col = "navy")
# ggplot(HeartDisease, aes(x=age, y=target)) +
#   geom_point() +
#   geom_smooth(method = 'glm', se=TRUE, method.args = list(family = 'binomial'))
age_hist <- ggplot(HeartDisease, aes(age, fill = target)) +
geom_histogram(bins = 15) +
scale_fill_manual(values = c("gray", 'navy'))
age_hist %>% ggplotly()
age_box <- ggplot(HeartDisease, aes(x=target, y = age)) +
geom_boxplot() +
scale_x_discrete(labels=c("No Heart Disease", "Have Heart Disease" )) +
ggtitle("Heart Disease by Age") +
xlab("Target") +
ylab("Age")
age_box %>% ggplotly()
bps_hist <- ggplot(HeartDisease, aes(trestbps, fill = target)) +
geom_histogram(bins = 15) +
scale_fill_manual(values = c("gray", 'navy'))
bps_hist %>% ggplotly()
bps_box <- ggplot(HeartDisease, aes(x=target, y = trestbps)) +
geom_boxplot() +
scale_x_discrete(labels=c("No Heart Disease", "Have Heart Disease" )) +
ggtitle("Heart Disease by Resting Blood Pressure") +
xlab("Target") +
ylab("Resting Blood Pressure")
bps_box %>% ggplotly()
chol_hist <- ggplot(HeartDisease, aes(chol, fill = target)) +
geom_histogram(bins = 15) +
scale_fill_manual(values = c("gray", 'navy'))
chol_hist %>% ggplotly()
chol_box <- ggplot(HeartDisease, aes(x=target, y = chol)) +
geom_boxplot() +
scale_x_discrete(labels=c("No Heart Disease", "Have Heart Disease" )) +
ggtitle("Heart Disease by Cholesterol Level") +
xlab("Target") +
ylab("Cholesterol mg/dl")
chol_box %>% ggplotly()
old_hist <- ggplot(HeartDisease, aes(oldpeak, fill = target)) +
geom_histogram(bins = 15) +
scale_fill_manual(values = c("gray", 'navy'))
old_hist %>% ggplotly()
old_box <- ggplot(HeartDisease, aes(x=target, y = oldpeak)) +
geom_boxplot() +
scale_x_discrete(labels=c("No Heart Disease", "Have Heart Disease" )) +
ggtitle("Heart Disease by ST Depression") +
xlab("Target") +
ylab("Oldpeak - ST Depression")
old_box %>% ggplotly()
cowplot::plot_grid(age_box, bps_box, chol_box, old_box)
library(officer)
ft <- qflextable(HD_var_data)
read_docx() %>%
body_add_flextable(value = ft) %>%
print(target = "C:/Users/dutch/OneDrive/Desktop/HD_var_data.docx")
ft
library(officer)
ft <- qflextable(HD_var_data)
read_docx() %>%
body_add_flextable(value = ft) %>%
print(target = "C:/Users/dutch/OneDrive/Desktop/HD_var_data.docx")
ft
